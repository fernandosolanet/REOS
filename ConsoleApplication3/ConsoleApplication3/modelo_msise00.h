#include <stdexcept>
#include <stdio.h>
#include <cmath>
using namespace std;

int R_AIR = 287;
double GAMMA = 1.4;
double BETA_VISC = 1.458e-6;
double S_VISC = 110.4;

double TEMPER[13][6] = {
	{ 288.4, -0.002696, -1.209e-6, 1.105e-10, -2.703e-15, 0 },
	{ 334.6, -0.01953, 1.0485e-6, -2.145e-11, 1.303e-16, 0 },
	{ 225.4, -0.002232, 8.624e-8, -3.209e-13, 0, 0 },
	{ 474.95, -0.00753, -6.382e-7, 3.0175e-11, -3.2195e-16, 0 },
	{ -2828, 0.1816, -3.495e-6, 2.203e-11, 0, 0 },
	{ 712.9, -0.016, 1.783e-7, -7.289e-13, 0, 0 },
	{ 1857, -.05847, 6.9745e-7, -2.8105e-12, 0, 0 },
	{ -4371, .1357, -1.114e-6, -2.772e-13, 2.41e-17, 0 },
	{ 17010, -.4213, 3.43e-6, -8.97e-12, 0, 0 },
	{ -5498.54, .0950362, -4.90839e-7, 8.72167e-13, 0, 0 },
	{ -2638, .0488, -2.58e-7, 6.156e-13, -5.569e-19, 0 },
	{ 8.9638, .010298, -4.8383e-8, 1.1428e-13, -1.3543e-19, 6.4307e-26 },
	{ 892.6, 0, 0, 0, 0, 0 }
};

double DENSIT[13][7] = {
	{ 1.2113, -1.0767e-4, 2.8143e-9, 0, 0, 0, 0 },
	{ 1.144, -9.3249e-5, 2.0283e-9, 0, 0, 0, 0 },
	{ 0.98121, -8.5625e-5, 2.59e-9, -2.6866e-14, 0, 0, 0 },
	{ 0.53696369783, -4.3597202128e-5, 1.3582294965e-9, -1.9138461925e-14, 1.0253010619e-19, 0, 0 },
	{ 0.030063, -1.0345e-6, 9.0937e-12, 0, 0, 0, 0 },
	{ 0.028566, -1.1743e-6, 1.6299e-11, -7.6239e-17, 0, 0, 0 },
	{ 0.021858322344, -9.8512966001e-7, 1.6779533018e-11, -1.279121248e-16, 3.6795165237e-22, 0, 0 },
	{ 0.018477335855, -9.0294288939e-7, 1.7720644879e-11, -1.7447869942e-16, 8.6142822069e-22, -1.7052994766e-27, 0 },
	{ 2.1772683977e-3, -8.9767045236e-8, 1.4829610326e-12, -1.2267775208e-17, 5.0809300164e-23, -8.427136289e-29, 0 },
	{ 6.21790234479e-5, -2.35674472104e-9, 3.72303267358e-14, -3.13620341158e-19, 1.48529238085e-24, -3.74874972816e-30, 3.938525302088e-36 },
	{ 1.6244922565e-7, -3.6911722938e-12, 3.530199049e-17, -1.8124348491e-22, 5.2555686765e-28, -8.1472260337e-34, 5.2685895499e-40 },
	{ 3.2983479421e-9, -3.9057260867e-14, 1.8766393702e-19, -4.5571029771e-25, 5.5779327744e-31, -2.7476359591e-37, 0 },
	{ 3.17056098e-10, -2.79591705e-15, 1.03325853e-20, -2.04426659e-26, 2.28016783e-32, -1.35785279e-38, 3.36960028e-45 }
};

int interval_msise00(const double& alt)
{
	int result = -1;
	int intervals[14] = { 0, 11000, 20000, 32000, 47000, 51000, 71000, 85000, 105000, 125000, 180000, 300000, 440000, 800000 };
	bool in_interval = false;
	if (alt < 0) {
		throw invalid_argument("Altitude under 0 m.");
	}
	else if (alt > 8e5) {
		throw invalid_argument("Altitude over 800 km.");
	}
	for (int i = 0; in_interval == false; ++i) {
		++result;
		in_interval = (intervals[i] <= alt) & (alt <= intervals[i + 1]);
	}
	return result;
}

double temperature(const double& alt)
{
	double tem = 0;
	int i = interval_msise00(alt);
	for (int j = 0; j <= 5; ++j) {
		tem = tem + TEMPER[i][j] * pow(alt, j);
	}
	return tem;
}

double density(const double& alt)
{
	double den = 0;
	int i = interval_msise00(alt);
	for (int j = 0; j <= 6; ++j) {
		den = den + DENSIT[i][j] * pow(alt, j);
	}
	return den;
}

double pressure(const double& alt)
{
	return density(alt) * R_AIR * temperature(alt);
}

double viscosity(const double& alt)
{
	return BETA_VISC * pow(temperature(alt), 1.5) / (temperature(alt) + S_VISC);
}
